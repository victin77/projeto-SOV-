<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SOV - Lead</title>
  <link rel="stylesheet" href="/css/style.css" />
</head>
<body class="bg">
  <header class="topbar">
    <div class="brand">
      <a class="btn btnGhost btnSmall" href="/app.html">← Kanban</a>
      <div class="logoMark" aria-hidden="true"></div>
      <div class="brandTitle">
        <strong>Detalhe do lead</strong>
        <div class="muted2 xs" id="who"></div>
      </div>
    </div>
    <div class="row">
      <button id="logoutBtn" class="btn btnGhost btnSmall">Sair</button>
    </div>
  </header>

  <main class="wrap">
    <section class="panel">
      <div class="row" style="justify-content:space-between;align-items:flex-start;gap:12px;flex-wrap:wrap">
        <div style="flex:1;min-width:280px">
          <h2 id="title">—</h2>
          <div class="muted small" id="meta">—</div>
        </div>
        <div class="row" style="gap:10px;flex-wrap:wrap">
          <button id="markWon" class="btn btnSuccess btnSmall">Marcar como ganho</button>
          <button id="markLost" class="btn btnDanger btnSmall">Marcar como perdido</button>
        </div>
      </div>

      <hr class="hr" />

      <div class="grid">
        <div>
          <label>Nome</label><input id="f_name" />
        </div>
        <div>
          <label>Telefone</label><input id="f_phone" />
        </div>
        <div>
          <label>Origem</label><input id="f_origin" />
        </div>
        <div>
          <label>Tipo</label>
          <select id="f_type">
            <option value="auto">Auto</option>
            <option value="imovel">Imóvel</option>
            <option value="agro">Agro</option>
          </select>
        </div>
        <div>
          <label>Valor estimado</label><input id="f_value" type="number" />
        </div>
        <div>
          <label>Etapa</label>
          <select id="f_stage"></select>
        </div>

        <div>
          <label>Próximo contato</label><input id="f_next" type="datetime-local" />
        </div>
        <div class="span2">
          <label>Próximo passo</label><input id="f_step" />
        </div>

        <div class="span2" id="ownerWrap" style="display:none">
          <label>Dono (consultor)</label>
          <select id="f_owner"></select>
          <div class="muted small">Apenas gestor/admin pode reatribuir.</div>
        </div>
      </div>

      <div class="row end">
        <button id="saveLead" class="btn btnPrimary">Salvar alterações</button>
      </div>
      <div id="err" class="error"></div>

      <hr class="hr" />

      <div class="grid" style="grid-template-columns:1.2fr .8fr;align-items:start">
        <div>
          <h3>Linha do tempo</h3>
          <div class="row" style="gap:10px;flex-wrap:wrap">
            <select id="i_type">
              <option value="whatsapp">WhatsApp</option>
              <option value="ligacao">Ligação</option>
              <option value="presencial">Presencial</option>
              <option value="outro">Outro</option>
            </select>
            <input id="i_note" placeholder="Escreva um resumo do contato..." style="flex:1;min-width:260px" />
            <button id="addInteraction" class="btn btnGhost">Adicionar</button>
          </div>
          <div id="interactions" class="list"></div>
        </div>

        <div>
          <h3>Tarefas</h3>
          <div class="row" style="gap:10px;flex-wrap:wrap">
            <input id="t_title" placeholder="Ex: follow-up" style="flex:1;min-width:160px" />
            <input id="t_due" type="datetime-local" />
            <button id="addTask" class="btn btnGhost">Criar</button>
          </div>
          <div id="tasks" class="list"></div>
        </div>
      </div>

      <hr class="hr" />

      <h3>Perda (se aplicável)</h3>
      <div id="lossBox" class="muted">Ainda não marcado como perdido.</div>
    </section>
  </main>

  <!-- modal perdido -->
  <div id="lossModal" class="modal hidden">
    <div class="modalCard">
      <h3>Marcar como Perdido</h3>
      <p class="muted">Motivo é obrigatório.</p>
      <div class="grid">
        <div class="span2">
          <label>Motivo</label>
          <input id="l_reason" placeholder="Ex: parcelou, preferiu financiamento..." />
        </div>
        <div>
          <label>Concorrente (opcional)</label>
          <input id="l_comp" />
        </div>
        <div>
          <label>Observação (opcional)</label>
          <input id="l_note" />
        </div>
      </div>
      <div class="row end">
        <button id="lossCancel" class="btn btnGhost">Cancelar</button>
        <button id="lossSave" class="btn btnDanger">Salvar</button>
      </div>
      <div id="l_err" class="error"></div>
    </div>
  </div>

  <script type="module" src="/js/lead.js"></script>
</body>
</html>
